(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{54:function(e,t,o){"use strict";o.r(t),o.d(t,"frontMatter",(function(){return l})),o.d(t,"metadata",(function(){return i})),o.d(t,"rightToc",(function(){return c})),o.d(t,"default",(function(){return s}));var n=o(2),r=o(6),a=(o(0),o(97)),l={title:"Apollo Angular Boost migration",description:"Learn how to set up Apollo Angular manually without Apollo Angular Boost"},i={unversionedId:"recipes/boost-migration",id:"recipes/boost-migration",isDocsHomePage:!1,title:"Apollo Angular Boost migration",description:"Learn how to set up Apollo Angular manually without Apollo Angular Boost",source:"@site/docs/recipes/boost-migration.md",permalink:"/docs/recipes/boost-migration",editUrl:"https://github.com/kamilkisiela/apollo-angular/edit/master/website/docs/recipes/boost-migration.md",version:"next",sidebar:"docs",previous:{title:"Angular CLI",permalink:"/docs/recipes/angular-cli"}},c=[{value:"Basic migration",id:"basic-migration",children:[{value:"Before",id:"before",children:[]},{value:"After",id:"after",children:[]}]},{value:"Advanced migration",id:"advanced-migration",children:[{value:"uri and HttpOptions",id:"uri-and-httpoptions",children:[]},{value:"clientState",id:"clientstate",children:[]},{value:"onError",id:"onerror",children:[]},{value:"cacheRedirects",id:"cacheredirects",children:[]}]},{value:"Summary",id:"summary",children:[]}],p={rightToc:c};function s(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(n.a)({},p,o,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Apollo Angular Boost is a great way to get started with Apollo Angular quickly, but there are some advanced features it doesn't support out of the box. If you'd like to use subscriptions, swap out the Apollo cache, or add an existing Apollo Link to your network stack that isn't already included, you will have to set Apollo Angular up manually."),Object(a.b)("p",null,"We're working on an eject feature (maybe Angular's schematic) for Apollo Angular Boost that will make migration easier in the future, but for now, let's walk through how to migrate off of Apollo Boost."),Object(a.b)("h2",{id:"basic-migration"},"Basic migration"),Object(a.b)("p",null,"If you're not using any configuration options on Apollo Angular Boost, migration should be relatively simple. All you will have to change is the file where you initialize Apollo."),Object(a.b)("h3",{id:"before"},"Before"),Object(a.b)("p",null,"Here's what client initialization looks like with Apollo Angular Boost:"),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),'import { HttpClientModule } from "@angular/common/http";\nimport { ApolloBoostModule, ApolloBoost } from "apollo-angular-boost";\n\n@NgModule({\n  imports: [\n    BrowserModule,\n    HttpClientModule,\n    ApolloBoostModule\n  ],\n  ...\n})\nexport class AppModule {\n  constructor(boost: ApolloBoost) {\n    boost.create({\n      uri: "https://o5x5jzoo7z.sse.codesandbox.io/graphql"\n    })\n  }\n}\n')),Object(a.b)("h3",{id:"after"},"After"),Object(a.b)("p",null,"To create a basic client with the same defaults as Apollo Angular Boost, first you need to install some packages:"),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"npm install --save \\\napollo-angular \\\napollo-angular-link-http \\\napollo-client \\\napollo-cache-inmemory \\\ngraphql-tag \\\ngraphql\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"apollo-client - core functionality for Apollo ecosystem"),Object(a.b)("li",{parentName:"ul"},"apollo-angular - Angular integration"),Object(a.b)("li",{parentName:"ul"},"apollo-cache-inmemory - basic, most popular cache"),Object(a.b)("li",{parentName:"ul"},"apollo-angular-link-http - allows to make requests through Angular's HttpClient"),Object(a.b)("li",{parentName:"ul"},"graphql-tag - a small utility to parse strings into GraphQL Documents"),Object(a.b)("li",{parentName:"ul"},"graphql - base functionality for everything")),Object(a.b)("p",null,"To complete the process, you'll need to manually attach your ",Object(a.b)("inlineCode",{parentName:"p"},"cache")," and ",Object(a.b)("inlineCode",{parentName:"p"},"link")," to the client:"),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"import {ApolloModule, Apollo} from 'apollo-angular';\nimport {InMemoryCache} from 'apollo-cache-inmemory';\nimport {HttpLinkModule, HttpLink} from 'apollo-angular-link-http';\nimport {onError} from 'apollo-link-error';\nimport {ApolloLink} from 'apollo-link';\n\n@NgModule({\n  imports: [\n    BrowserModule,\n    HttpClientModule,\n    ApolloModule,\n    HttpLinkModule\n  ],\n  ...\n})\nexport class AppModule {\n  constructor(apollo: Apollo, httpLink: HttpLink) {\n    apollo.create({\n      link: ApolloLink.from([\n        onError(({graphQLErrors, networkError}) => {\n          if (graphQLErrors)\n            graphQLErrors.map(({message, locations, path}) =>\n              console.log(\n                `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`,\n              ),\n            );\n          if (networkError) console.log(`[Network error]: ${networkError}`);\n        }),\n        httpLink.create({\n          uri: 'https://o5x5jzoo7z.sse.codesandbox.io/graphql',\n          withCredentials: true,\n        }),\n      ]),\n      cache: new InMemoryCache(),\n    });\n  }\n}\n")),Object(a.b)("p",null,"The ",Object(a.b)("inlineCode",{parentName:"p"},"InMemoryCache")," is our recommended cache implementation for Apollo Client. The ",Object(a.b)("inlineCode",{parentName:"p"},"HttpLink")," is an Apollo Link that sends HTTP requests through Angular's HttpClient. Your network stack can be made up of one or more links, which you can chain together to create a customizable network stack. Learn more in our ",Object(a.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/basics/network-layer"}),"network layer")," guide or the ",Object(a.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.apollographql.com/docs/link/"}),"Apollo Link")," docs."),Object(a.b)("h2",{id:"advanced-migration"},"Advanced migration"),Object(a.b)("p",null,"If you are using configuration options on Apollo Angular Boost, your migration path will vary depending on which ones you use."),Object(a.b)("p",null,"Type your configuration options object as ApolloClientOptions so you can use IntelliSense features on your editor."),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"export function createApollo(httpLink: HttpLink) {\n  return {\n    cache: new InMemoryCache(),\n    link: ApolloLink.from([\n      onError(({ graphQLErrors, networkError }) => {\n        ...\n      }),\n      httpLink.create({\n        uri: aux.env.graphql\n      }),\n    ]),\n    resolvers,\n    typeDefs\n  } as ApolloClientOptions<any>;\n}\n")),Object(a.b)("p",null,"We will try to step by step eject each configuration."),Object(a.b)("h3",{id:"uri-and-httpoptions"},"uri and HttpOptions"),Object(a.b)("p",null,"Basically, you merge ",Object(a.b)("inlineCode",{parentName:"p"},"uri")," property with an object passed as ",Object(a.b)("inlineCode",{parentName:"p"},"httpOptions"),":"),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"{\n  uri: 'http://example.api',\n  httpOptions: {\n    withCredentials: true\n  }\n}\n")),Object(a.b)("p",null,"Become:"),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"{\n  uri: 'http://example.api',\n  withCredentials: true\n}\n")),Object(a.b)("p",null,"This one, you put to ",Object(a.b)("inlineCode",{parentName:"p"},"HttpLink.create()"),"."),Object(a.b)("h3",{id:"clientstate"},"clientState"),Object(a.b)("p",null,"You can pass all the proprieties of the object to ",Object(a.b)("inlineCode",{parentName:"p"},"apollo-link-state")," by also including ApolloCache."),Object(a.b)("pre",null,Object(a.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"{\n    cache: new InMemoryCache(),\n    link: ApolloLink.from([\n      ...\n    ]),\n    resolvers,\n    typeDefs\n  }\n")),Object(a.b)("h3",{id:"onerror"},"onError"),Object(a.b)("p",null,"Similar as in clientState, you use the config in ",Object(a.b)("inlineCode",{parentName:"p"},"apollo-link-error"),"."),Object(a.b)("h3",{id:"cacheredirects"},"cacheRedirects"),Object(a.b)("p",null,"Whatever you have here, just pass it to ",Object(a.b)("inlineCode",{parentName:"p"},"apollo-cache-inmemory"),"."),Object(a.b)("h2",{id:"summary"},"Summary"),Object(a.b)("p",null,"That's it! If something is hard to think about or understand feel free to open an issue, we will help you and by doing this you will help others!"))}s.isMDXComponent=!0},97:function(e,t,o){"use strict";o.d(t,"a",(function(){return u})),o.d(t,"b",(function(){return d}));var n=o(0),r=o.n(n);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function c(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var p=r.a.createContext({}),s=function(e){var t=r.a.useContext(p),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=s(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=s(o),m=n,d=u["".concat(l,".").concat(m)]||u[m]||b[m]||a;return o?r.a.createElement(d,i(i({ref:t},p),{},{components:o})):r.a.createElement(d,i({ref:t},p))}));function d(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,l=new Array(a);l[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var p=2;p<a;p++)l[p]=o[p];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,o)}m.displayName="MDXCreateElement"}}]);